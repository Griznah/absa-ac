<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AC Bot Configuration</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <script defer src="/static/js/alpine.min.js"></script>
    <script defer src="/static/js/app.js"></script>
</head>
<body x-data="app()">
    <!-- Login Modal -->
    <div class="modal" x-show="!token" x-transition>
        <div class="modal-content">
            <h2>Authentication Required</h2>
            <input type="password" x-model="inputToken" placeholder="Enter API token">
            <button @click="login()">Login</button>
        </div>
    </div>

    <!-- Main Config Form -->
    <div class="container" x-show="token">
        <h1>Server Configuration</h1>

        <!-- Global Settings -->
        <section>
            <h2>Global Settings</h2>
            <label>Server IP</label>
            <input type="text" x-model="config.server_ip">

            <label>Update Interval (seconds)</label>
            <input type="number" x-model="config.update_interval" min="1">
        </section>

        <!-- Categories -->
        <section>
            <h2>Categories</h2>
            <template x-for="(category, index) in config.category_order" :key="index">
                <div class="category-item">
                    <input type="text" x-model="config.category_order[index]">
                    <input type="text" x-model="config.category_emojis[category]">
                </div>
            </template>
        </section>

        <!-- Servers -->
        <section>
            <h2>Servers</h2>
            <template x-for="(server, index) in config.servers" :key="index">
                <div class="server-item">
                    <input type="text" x-model="server.name" placeholder="Server Name">
                    <input type="number" x-model="server.port" min="1" max="65535">
                    <select x-model="server.category">
                        <template x-for="cat in config.category_order" :key="cat">
                            <option :value="cat" x-text="cat"></option>
                        </template>
                    </select>
                    <button @click="removeServer(index)" class="btn-delete">Delete</button>
                </div>
            </template>
            <button @click="addServer()">Add Server</button>
        </section>

        <!-- Actions -->
        <div class="actions">
            <button @click="save()" :disabled="!dirty">Save Changes</button>
            <span x-show="saved" class="success-message">Saved!</span>
            <span x-show="error" x-text="error" class="error-message"></span>
            <span x-show="remoteChanged" class="warning-message">Remote config changed - reload to see latest or save to overwrite</span>
        </div>
    </div>
</body>
</html>
